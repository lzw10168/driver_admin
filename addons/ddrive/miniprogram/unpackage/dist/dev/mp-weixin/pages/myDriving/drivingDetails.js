(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myDriving/drivingDetails"],{169:
/*!****************************************************************************************************************************!*\
  !*** D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/main.js?{"page":"pages%2FmyDriving%2FdrivingDetails"} ***!
  \****************************************************************************************************************************/
/*! no static exports found */function(t,e,r){"use strict";(function(t){r(/*! uni-pages */4);n(r(/*! vue */2));var e=n(r(/*! ./pages/myDriving/drivingDetails.vue */170));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,r(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},170:
/*!*********************************************************************************************************!*\
  !*** D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue ***!
  \*********************************************************************************************************/
/*! no static exports found */function(t,e,r){"use strict";r.r(e);var n=r(/*! ./drivingDetails.vue?vue&type=template&id=0f3b4c88&scoped=true& */171),o=r(/*! ./drivingDetails.vue?vue&type=script&lang=js& */173);for(var a in o)"default"!==a&&function(t){r.d(e,t,(function(){return o[t]}))}(a);r(/*! ./drivingDetails.vue?vue&type=style&index=0&id=0f3b4c88&lang=scss&scoped=true& */175);var u,i=r(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */10),c=Object(i["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,"0f3b4c88",null,!1,n["components"],u);c.options.__file="pages/myDriving/drivingDetails.vue",e["default"]=c.exports},171:
/*!****************************************************************************************************************************************************!*\
  !*** D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue?vue&type=template&id=0f3b4c88&scoped=true& ***!
  \****************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,r){"use strict";r.r(e);var n=r(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./drivingDetails.vue?vue&type=template&id=0f3b4c88&scoped=true& */172);r.d(e,"render",(function(){return n["render"]})),r.d(e,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(e,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(e,"components",(function(){return n["components"]}))},172:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue?vue&type=template&id=0f3b4c88&scoped=true& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,r){"use strict";r.r(e),r.d(e,"render",(function(){return o})),r.d(e,"staticRenderFns",(function(){return u})),r.d(e,"recyclableRender",(function(){return a})),r.d(e,"components",(function(){return n}));var n={tkiQrcode:function(){return Promise.all(/*! import() | components/tki-qrcode/tki-qrcode */[r.e("common/vendor"),r.e("components/tki-qrcode/tki-qrcode")]).then(r.bind(null,/*! @/components/tki-qrcode/tki-qrcode.vue */256))}},o=function(){var t=this,e=t.$createElement,r=(t._self._c,2==t.order.status?t._f("kilometer")(t.actual.distance):null),n=-1!=t.order.status&&3!=t.order.status&&99!=t.order.status||-1==t.order.status?null:t._f("kilometer")(t.order.distance),o=-1!=t.order.status&&3!=t.order.status&&99!=t.order.status||-1==t.order.status?null:t._f("duration")(t.order.duration);t.$mp.data=Object.assign({},{$root:{f0:r,f1:n,f2:o}})},a=!1,u=[];o._withStripped=!0},173:
/*!**********************************************************************************************************************************!*\
  !*** D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************************************/
/*! no static exports found */function(t,e,r){"use strict";r.r(e);var n=r(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./drivingDetails.vue?vue&type=script&lang=js& */174),o=r.n(n);for(var a in n)"default"!==a&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},174:
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(r(/*! ./node_modules/@babel/runtime/regenerator */17)),o=i(r(/*! ../../libs/qqmap-wx-jssdk/qqmap-wx-jssdk.js */20)),a=i(r(/*! ../../common/helper.js */21)),u=i(r(/*! ../../common/api.js */22));function i(t){return t&&t.__esModule?t:{default:t}}function c(t,e,r,n,o,a,u){try{var i=t[a](u),c=i.value}catch(s){return void r(s)}i.done?e(c):Promise.resolve(c).then(n,o)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){c(a,n,o,u,i,"next",t)}function i(t){c(a,n,o,u,i,"throw",t)}u(void 0)}))}}var d=function(){Promise.all(/*! require.ensure | components/tki-qrcode/tki-qrcode */[r.e("common/vendor"),r.e("components/tki-qrcode/tki-qrcode")]).then(function(){return resolve(r(/*! @/components/tki-qrcode/tki-qrcode.vue */256))}.bind(null,r)).catch(r.oe)},l={components:{tkiQrcode:d},data:function(){return{map:{latitude:"",longitude:"",covers:[],scale:16,polyline:[]},focus:!1,price:"",order:{},orderId:"",timer:"",isDirection:!1,actual:{price:0,distance:0},route:{duration:"--"},paystr:""}},filters:{kilometer:function(t){var e=parseFloat(t/1e3);return e.toFixed(2)},duration:function(t){if(t>3600){var e=parseInt(t/3600),r=t%3600;return r>0?e+"小时"+parseInt(r/60)+"分钟":e+"小时"}return parseInt(t/60)+"分钟"}},onLoad:function(t){this.initSdk(),this.orderId=t.order_id,this.getOrderInfo()},onShow:function(){this.orderId&&this.getOrderInfo()},onHide:function(){this.timer&&(console.log("清除定时器"),clearInterval(this.timer),this.timer="")},methods:{call:function(e){t.makePhoneCall({phoneNumber:e})},reach:function(){var e=this;t.showModal({title:"操作提示",content:"请确认已到达出发地点等待用户",success:function(){var t=s(n.default.mark((function t(r){var o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.confirm){t.next=5;break}return t.next=3,u.default.orderReach(e.orderId);case 3:o=t.sent,1==o.code?e.getOrderInfo():a.default.toast(o.msg);case 5:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}()})},done:function(){var e=this;t.showModal({title:"操作提示",content:"请确认已经达到目的地",success:function(){var r=s(n.default.mark((function r(o){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:o.confirm&&t.getLocation({type:"gcj02",success:function(){var t=s(n.default.mark((function t(r){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(2),t.next=3,e.updateOrderInfo();case 3:return t.next=5,u.default.doneOrder({order_id:e.orderId,latitude:r.latitude,longitude:r.longitude});case 5:t.sent,e.getOrderInfo();case 7:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}(),fail:function(t){a.default.toast("获取位置失败")}});case 1:case"end":return r.stop()}}),r)})));function o(t){return r.apply(this,arguments)}return o}()})},start:function(){var e=this;t.showModal({title:"操作提示",content:"请确认已接到用户并马上出发吗？",success:function(){var r=s(n.default.mark((function r(o){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:o.confirm&&(console.log(1),t.getLocation({type:"gcj02",success:function(){var t=s(n.default.mark((function t(r){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(2),t.next=3,u.default.startOrder({order_id:e.orderId,latitude:r.latitude,longitude:r.longitude});case 3:t.sent,e.getOrderInfo();case 5:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}(),fail:function(t){a.default.toast("获取位置失败")}}));case 1:case"end":return r.stop()}}),r)})));function o(t){return r.apply(this,arguments)}return o}()})},initSdk:function(){this.qqmapsdk=new o.default({key:a.default.config.qqmapsdk.key})},getOrderPayScanInfo:function(){var t=this;return s(n.default.mark((function e(){var r;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.default.getOrderPayScanInfo(t.orderId);case 2:r=e.sent,t.paystr=r,console.log(t.paystr);case 5:case"end":return e.stop()}}),e)})))()},getOrderInfo:function(){var t=this;return s(n.default.mark((function e(){var r;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("获取订单信息"),e.next=3,u.default.getOrderInfo(t.orderId);case 3:r=e.sent,t.order=r.data,1!=t.order.status&&4!=t.order.status||(t.map.latitude=r.data.start_latitude,t.map.longitude=r.data.start_longitude,t.map.covers.push({latitude:r.data.start_latitude,longitude:r.data.start_longitude,iconPath:"../../static/marker.png"})),2==t.order.status&&t.updateOrderInfo(),3!=t.order.status||t.paystr||t.getOrderPayScanInfo(),99==t.order.status||t.timer||(console.log("注册定时器"),t.timer=setInterval((function(){t.getOrderInfo()}),1e4)),99==t.order.status&&t.timer&&(console.log("清除定时器"),clearInterval(t.timer),t.timer="");case 10:case"end":return e.stop()}}),e)})))()},updateOrderInfo:function(){var e=this;t.getLocation({type:"gcj02",success:function(){var t=s(n.default.mark((function t(r){var o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.currLocation=r,e.map.latitude=r.latitude,e.map.longitude=r.longitude,e.map.covers=[{latitude:r.latitude,longitude:r.longitude,iconPath:"../../static/marker.png"}],r.order_id=e.orderId,t.next=7,u.default.updateOrderLocation(r);case 7:o=t.sent,e.actual=o.data,e.direction();case 10:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}()})},direction:function(){var t=this;this.qqmapsdk.direction({mode:"driving",from:this.currLocation.latitude+","+this.currLocation.longitude,to:this.order.end_latitude+","+this.order.end_longitude,complete:function(e){if(!e.result||!e.result.routes||0==e.result.routes.length)return a.default.toast("未获取到有效路线"),!1;var r=e.result.routes[0].polyline,n=[];t.route=e.result.routes[0];for(var o=1e6,u=2;u<r.length;u++)r[u]=Number(r[u-2])+Number(r[u])/o;for(var i=0;i<r.length;i+=2)n.push({latitude:r[i],longitude:r[i+1]});t.map.latitude=n[0].latitude,t.map.longitude=n[0].longitude,t.map.polyline=[{points:n,color:"#227AFF",width:4}],t.isDirection=!0}})}}};e.default=l}).call(this,r(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},175:
/*!*******************************************************************************************************************************************************************!*\
  !*** D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue?vue&type=style&index=0&id=0f3b4c88&lang=scss&scoped=true& ***!
  \*******************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,r){"use strict";r.r(e);var n=r(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./drivingDetails.vue?vue&type=style&index=0&id=0f3b4c88&lang=scss&scoped=true& */176),o=r.n(n);for(var a in n)"default"!==a&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},176:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!D:/PHP/phpstudy_pro/WWW/ddcar_server/addons/ddrive/miniprogram/pages/myDriving/drivingDetails.vue?vue&type=style&index=0&id=0f3b4c88&lang=scss&scoped=true& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,r){}},[[169,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/myDriving/drivingDetails.js.map